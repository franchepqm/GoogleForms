function enviarCorreoAutomatizado(e) {
  if (!e || !e.response) {
    Logger.log("‚ùå Error: El evento no contiene datos de respuesta.");
    return;
  }

  const respuestas = e.response.getItemResponses();
  let emailUsuario = '';
  let mensaje = 'Nueva inscripci√≥n recibida:\n\n';

  // Recorrer las respuestas para obtener el email y generar el mensaje
  respuestas.forEach(respuesta => {
    const pregunta = respuesta.getItem().getTitle();
    const valor = respuesta.getResponse();

    // Detectar estrictamente el campo "Correo electronico"
    if (pregunta === "Correo electronico") {
      emailUsuario = valor.trim();
      Logger.log(`üìß Correo detectado: ${emailUsuario}`);
    }

    // Agregar todas las respuestas al mensaje
    mensaje += `${pregunta}: ${valor}\n`;
  });

  // Verificar si se detect√≥ un correo v√°lido
  if (emailUsuario) {
    try {
      GmailApp.sendEmail(
        emailUsuario,
        "Gracias por tu respuesta",
        "Hola, gracias por completar nuestro formulario. Pronto nos pondremos en contacto contigo."
      );
      Logger.log(`‚úÖ Correo enviado correctamente a: ${emailUsuario}`);
    } catch (error) {
      Logger.log(`‚ùå Error al enviar correo al usuario: ${error}`);
    }
  } else {
    Logger.log("‚ùó No se detect√≥ ning√∫n correo electr√≥nico en la respuesta.");
  }

  // Enviar correo a tu equipo con los datos del formulario
  const correoEquipo = "tuemail@gmail.com";  // Reemplaza con tu correo
  try {
    GmailApp.sendEmail(
      correoEquipo,
      "üì© Nueva inscripci√≥n en el formulario",
      mensaje
    );
    Logger.log(`‚úÖ Correo de notificaci√≥n enviado a tu equipo: ${correoEquipo}`);
  } catch (error) {
    Logger.log(`‚ùå Error al enviar correo a tu equipo: ${error}`);
  }
}
